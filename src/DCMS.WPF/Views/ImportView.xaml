<UserControl x:Class="DCMS.WPF.Views.ImportView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             FlowDirection="RightToLeft"
             Background="#F5F5F5">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
    </UserControl.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="White" Padding="20" CornerRadius="8" Margin="0,0,0,15">
            <Border.Effect>
                <DropShadowEffect Color="#E0E0E0" BlurRadius="8" ShadowDepth="2" Opacity="0.3"/>
            </Border.Effect>
            <StackPanel>
                <TextBlock Text="ðŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Excel" FontSize="24" FontWeight="Bold" Foreground="#1976D2"/>
                <TextBlock Text="Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø±Ø§Ø³Ù„Ø§Øª 2025 Ù…Ù† Ù…Ù„Ù Excel Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" 
                           FontSize="14" Foreground="#666" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- File Selection -->
        <Border Grid.Row="1" Background="White" Padding="20" CornerRadius="8" Margin="0,0,0,15">
            <Border.Effect>
                <DropShadowEffect Color="#E0E0E0" BlurRadius="8" ShadowDepth="2" Opacity="0.3"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBox Grid.Column="0" 
                         Text="{Binding SelectedFilePath, Mode=TwoWay}" 
                         IsReadOnly="True"
                         Padding="12"
                         FontSize="14"
                         VerticalContentAlignment="Center"
                         Background="#FAFAFA"/>
                
                <Button Grid.Column="1" 
                        Command="{Binding BrowseCommand}"
                        Content="ðŸ“ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù"
                        Padding="20,12"
                        Margin="10,0,0,0"
                        Background="#2196F3"
                        Foreground="White"
                        FontWeight="Bold"
                        BorderThickness="0"
                        Cursor="Hand">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="6"/>
                        </Style>
                    </Button.Resources>
                </Button>
            </Grid>
        </Border>

        <!-- Import Info -->
        <Border Grid.Row="2" Background="#E3F2FD" Padding="15" CornerRadius="8" Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="ðŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯:" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                <TextBlock Text="â€¢ Ø³ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† ØµÙØ­Ø§Øª: ÙˆØ§Ø±Ø¯ØŒ Ù…ØªØ§Ø¨Ø¹Ø©ØŒ ØµØ§Ø¯Ø±" FontSize="13"/>
                <TextBlock Text="â€¢ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ù‡ Ù„ØµÙŠØºØ© 25-XXXX" FontSize="13"/>
                <TextBlock Text="â€¢ Ù„Ù† ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© (Ù†ÙØ³ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹)" FontSize="13"/>
                <TextBlock Text="â€¢ Ø³ÙŠØªÙ… Ø¯Ù…Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¹ Ø§Ù„ÙˆØ§Ø±Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹" FontSize="13"/>
            </StackPanel>
        </Border>

        <!-- Progress Log -->
        <Border Grid.Row="3" Background="White" Padding="15" CornerRadius="8" Margin="0,0,0,15">
            <Border.Effect>
                <DropShadowEffect Color="#E0E0E0" BlurRadius="6" ShadowDepth="1" Opacity="0.2"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="ðŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                
                <ProgressBar Grid.Row="1" 
                             Value="{Binding ProgressValue}" 
                             Maximum="100" 
                             Height="8" 
                             Margin="0,0,0,10"
                             Foreground="#4CAF50"/>
                
                <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
                    <TextBox Text="{Binding ProgressLog, Mode=OneWay}" 
                             IsReadOnly="True"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             Background="#FAFAFA"
                             Padding="10"
                             FontFamily="Consolas"
                             FontSize="12"/>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Actions -->
        <Border Grid.Row="4" Background="White" Padding="20,15" CornerRadius="8">
            <Border.Effect>
                <DropShadowEffect Color="#E0E0E0" BlurRadius="8" ShadowDepth="2" Opacity="0.3"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="{Binding StatusMessage}" FontSize="14" Foreground="#666"/>
                </StackPanel>
                
                <Button Grid.Column="1" 
                        Command="{Binding ImportCommand}"
                        Content="ðŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯"
                        Padding="30,12"
                        Background="#4CAF50"
                        Foreground="White"
                        FontWeight="Bold"
                        FontSize="16"
                        BorderThickness="0"
                        Cursor="Hand">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="6"/>
                        </Style>
                    </Button.Resources>
                </Button>
            </Grid>
        </Border>

        <!-- Loading Overlay -->
        <Border Grid.RowSpan="5" Background="#80000000" CornerRadius="8"
                Visibility="{Binding IsImporting, Converter={StaticResource BoolToVisibility}}">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="â³" FontSize="48" HorizontalAlignment="Center"/>
                <TextBlock Text="Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯..." FontSize="20" Foreground="White" 
                           HorizontalAlignment="Center" Margin="0,15,0,0" FontWeight="Bold"/>
                <TextBlock Text="{Binding StatusMessage}" FontSize="14" Foreground="#DDD" 
                           HorizontalAlignment="Center" Margin="0,10,0,0"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
